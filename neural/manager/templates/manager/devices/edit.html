{% extends "manager/base.html" %}

{% block title %}Editar Dispositivo{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<nav class="breadcrumb-nav">
  <a href="{% url 'manager:user_list' %}">Usuarios</a>
  <span class="separator">/</span>
  <a href="{% url 'manager:user_detail' user_obj.pk %}">{{ user_obj.first_name }} {{ user_obj.last_name }}</a>
  <span class="separator">/</span>
  <span class="current">Editar Dispositivo</span>
</nav>

<div class="page-header">
  <div>
    <h1>Editar Dispositivo</h1>
    <p>{{ object.get_platform_display }} - {{ object.device_id|truncatechars:30 }}</p>
  </div>
</div>

<div style="max-width: 600px;">
  <div class="main-card">
    <div class="card-header-section">
      <h2 class="card-title">Informaci√≥n del Dispositivo</h2>
    </div>
    <div class="card-body">
      <form method="post" novalidate>
        {% csrf_token %}

        <div class="form-group">
          <label class="form-label">Usuario</label>
          <div style="padding:0.5rem 0.75rem; background:var(--bg-secondary); border-radius:0.375rem; border:1px solid var(--border-default);">
            <span style="font-size:0.875rem;">{{ user_obj.first_name }} {{ user_obj.last_name }} ({{ user_obj.email }})</span>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Plataforma</label>
          <div style="padding:0.5rem 0.75rem; background:var(--bg-secondary); border-radius:0.375rem; border:1px solid var(--border-default);">
            <span style="font-size:0.875rem; display:flex; align-items:center; gap:0.5rem;">
              <i class="ti ti-{% if object.platform == 'ios' %}brand-apple{% else %}brand-android{% endif %}"></i>
              {{ object.get_platform_display }}
            </span>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Device ID</label>
          <div style="padding:0.5rem 0.75rem; background:var(--bg-secondary); border-radius:0.375rem; border:1px solid var(--border-default);">
            <code style="font-size:0.75rem; word-break:break-all;">{{ object.device_id }}</code>
          </div>
        </div>

        <div class="form-group">
          <label for="id_token" class="form-label">Push Token *</label>
          {{ form.token }}
          {% if form.token.errors %}
            <div class="form-error">{{ form.token.errors.0 }}</div>
          {% endif %}
          <div class="form-help">Token de Expo Push Notifications (ExponentPushToken[...])</div>
        </div>

        <div class="form-group">
          <label style="display:flex; align-items:center; gap:0.5rem; cursor:pointer;">
            {{ form.is_active }}
            <span class="form-label" style="margin:0;">Dispositivo Activo</span>
          </label>
          <div class="form-help">Desactiva el dispositivo para dejar de enviarle notificaciones</div>
        </div>

        <div style="display:flex; gap:0.75rem; margin-top:1.5rem;">
          <button type="submit" class="btn-primary">
            <i class="ti ti-device-floppy"></i>
            Guardar Cambios
          </button>
          <a href="{% url 'manager:user_detail' user_obj.pk %}" class="btn-outline">
            Cancelar
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
